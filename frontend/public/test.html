<!DOCTYPE html>
<html>
   <body>
      

      <div id="CubePositionX" style="position:fixed; left:90%; bottom:4%; color:grey;"></div>
      <div id="CubePositionY" style="position:fixed; left:90%; bottom:8%; color:grey;"> </div>

      <script src="http://threejs.org/build/three.min.js"></script>
      <script src="http://jeromeetienne.github.io/threex.keyboardstate/threex.keyboardstate.js"></script>
      <script src="../virtualjoystick.js"></script>
      <script>
	  
		<!-- Creating variables --> 
		var scene = new THREE.Scene();
		var camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
		var clock = new THREE.Clock();
		var keyboard = new THREEx.KeyboardState();

		<!-- Adding a new joystick to the webpage. It is positioned at 1350, 620. The inner ball can be moved 50 away from the middle. StationaryBase is true to have a fixed position. Mousesupport is true so that the joystick can be moved around. -->
		var joystick = new VirtualJoystick({mouseSupport: true, stationaryBase: true, baseX: 1350,baseY: 620,limitStickTravel: true, stickRadius: 50});
		var renderer = new THREE.WebGLRenderer();
		renderer.setSize(window.innerWidth, window.innerHeight);
		document.body.appendChild(renderer.domElement);
		window.addEventListener('resize', onWindowResize, false); 

		<!-- cube stuff --> 
		var cubeGeometry = new THREE.CubeGeometry(20,20,20);
		var cubeMaterial = new THREE.MeshLambertMaterial({ color: 'rgb(0,255,0)' });
		var cube = new THREE.Mesh(cubeGeometry, cubeMaterial);
		scene.add(cube);

		<!-- sphere stuff-->
		var sphereGeometry = new THREE.SphereGeometry(5);
		var sphereMaterial = new THREE.MeshBasicMaterial({ color: 'rgb(255,255,0)' });
		var sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
		scene.add(sphere);


		var light = new THREE.PointLight( 'rgb(255,255,255)', 1, 0 );
		scene.add(light);
		var sunRiseFlag = true;
		var sunHeight = 0;
		var frameTime = 0;
		camera.position.y = 40;
		camera.position.z = 160;
		cube.rotation.x = 0.4;
		cube.rotation.y = 0.6;



		var debugText1 = document.getElementById("CubePositionX");
		var debugText2 = document.getElementById("CubePositionY");
		animate();

		function animate(){
		   
		   requestAnimationFrame(animate);
		   frameTime = clock.getDelta();
		   if(sunRiseFlag == true){
			  sunHeight = sunHeight + 60 * frameTime;
		   }
		   if(sunRiseFlag == false){
			  sunHeight = sunHeight - 60 * frameTime;
		   }
		   if(sunHeight > 150){
			  sunHeight = 150;
			  sunRiseFlag = false;
		   }
		   if(sunHeight < 0){
			  sunHeight = 0;
			  sunRiseFlag = true;
		   }
		   light.position.set(50,sunHeight,50);
		   sphere.position = light.position;
		   
		   if( keyboard.pressed("D") ){
		 cube.position.x = cube.position.x + 60 * frameTime;
		   }
		   if( keyboard.pressed("A") ){
		 cube.position.x = cube.position.x - 60 * frameTime;
		   }
		   if( keyboard.pressed("W") ){
		 cube.position.y = cube.position.y + 60 * frameTime;
		   }
		   if( keyboard.pressed("S") ){
		 cube.position.y = cube.position.y - 60 * frameTime;
		   }
		   if( joystick.right() ){
		 cube.position.x = cube.position.x + 60 * frameTime;    
		   }
		   if( joystick.left() ){
		 cube.position.x = cube.position.x - 60 * frameTime;     
		   }
		   if( joystick.up() ){
		 cube.position.y = cube.position.y + 60 * frameTime;       
		   }
		   if( joystick.down() ){
		 cube.position.y = cube.position.y - 60 * frameTime;
		   }
		   renderer.render( scene, camera );
		   
		   debugText1.innerHTML = "Cube position X: " + cube.position.x.toFixed(1);
		   debugText2.innerHTML = "Cube position Y: " + cube.position.y.toFixed(1);
		   
		}
		function onWindowResize(){
		   camera.aspect = window.innerWidth / window.innerHeight;
		   camera.updateProjectionMatrix();
		   renderer.setSize( window.innerWidth, window.innerHeight );   
		}
      </script>     
   </body>
</html>